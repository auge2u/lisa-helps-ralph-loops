{
  "$schema": "semantic-memory-v1",
  "project": {
    "name": "lisa",
    "display_name": "Lisa - Staged Migration System for Gastown",
    "type": "claude-code-plugin",
    "primary_language": "Python",
    "version": "0.3.0",
    "description": "Staged migration system that analyzes codebases, extracts work items as Beads, bundles them into Convoys, and generates .gt/ directory structure for multi-agent execution via Gastown.",
    "repository": "https://github.com/auge2u/lisa-helps-ralph-loops",
    "license": "MIT",
    "status": "alpha",
    "category": "productivity",
    "keywords": ["gastown", "migration", "multi-agent", "beads", "convoys", "roadmap", "rescue", "semantic-memory"]
  },
  "tech_stack": {
    "runtime": "Python 3.10+",
    "primary_dependency": "PyYAML (optional — fallback mode without it)",
    "testing": "pytest (pytest -v, 25 tests)",
    "validation": "validate.py (833 lines, loads gates.yaml, PyYAML-free fallback mode)",
    "output_format": "JSON (.gt/ state files) + Markdown (scopecraft/)",
    "versioning": "scripts/bump-version.sh (syncs plugins/lisa/.claude-plugin/plugin.json + .claude-plugin/marketplace.json + CHANGELOG.md)"
  },
  "ecosystem_role": {
    "role": "pipeline-and-memory",
    "description": "Owns the staged pipeline (research, discover, plan, structure, reconcile) and the .gt/ directory schema. Ecosystem root for reconciliation.",
    "reads_from": [
      "target project files (package.json, README.md, docs/, etc.)",
      "carlos/.gt/memory/semantic.json (for reconcile)",
      "conductor/.gt/memory/semantic.json (for reconcile)",
      "~/.lisa/ecosystem.json (ecosystem-config-v2, project paths + git remotes for reconcile)"
    ],
    "writes_to": [
      ".gt/research/ (stage 0)",
      ".gt/memory/ (stage 1)",
      "scopecraft/ (stage 2)",
      ".gt/beads/ (stage 3)",
      ".gt/convoys/ (stage 3)",
      "scopecraft/.checkpoint.json (reconcile)",
      "scopecraft/ALIGNMENT_REPORT.md (reconcile)",
      "scopecraft/PERSPECTIVES.md (reconcile)"
    ],
    "does_not_own": [
      "Carlos analysis reports",
      "Conductor state (task queue, file locks, agent lifecycle)"
    ],
    "standalone": true,
    "standalone_command": "/lisa:migrate",
    "ecosystem_root": "this repo (hosts reconcile and ecosystem scopecraft/)"
  },
  "capabilities": {
    "commands": [
      {"name": "/lisa:research", "purpose": "Stage 0: Archaeological rescue for abandoned projects", "stage": 0},
      {"name": "/lisa:discover", "purpose": "Stage 1: Extract semantic memory from project analysis", "stage": 1},
      {"name": "/lisa:plan", "purpose": "Stage 2: Generate roadmap with epics, risks, metrics", "stage": 2},
      {"name": "/lisa:structure", "purpose": "Stage 3: Create Beads and Convoys for Gastown", "stage": 3},
      {"name": "/lisa:status", "purpose": "Show migration progress and quality gate results"},
      {"name": "/lisa:migrate", "purpose": "Composite: stages 1-3 (discover + plan + structure)"},
      {"name": "/lisa:rescue", "purpose": "Composite: stages 0-3 (research + discover + plan + structure)"},
      {"name": "/lisa:reconcile", "purpose": "Stage 5: Cross-project alignment report and checkpoint", "stage": 5}
    ],
    "agents": [
      {"name": "archaeologist", "role": "Archaeological rescue specialist", "stage": 0},
      {"name": "migrator", "role": "Project migration specialist", "stages": [1, 2, 3, 5]}
    ],
    "skills": [
      {"name": "research", "purpose": "Git archaeology, timeline, mission extraction"},
      {"name": "discover", "purpose": "Tech stack detection, semantic memory generation"},
      {"name": "plan", "purpose": "Roadmap generation with templates"},
      {"name": "structure", "purpose": "Bead extraction and convoy bundling (bd/gt CLI integration)"},
      {"name": "reconcile", "purpose": "Cross-project ecosystem alignment and drift detection"}
    ],
    "quality_gates": 31,
    "gate_stages": ["research", "discover", "plan", "structure", "reconcile"],
    "gate_source": "gates.yaml v1.1 (298 lines, declarative, single source of truth)"
  },
  "validation": {
    "validator": "plugins/lisa/hooks/validate.py",
    "lines_of_code": 833,
    "gates_config": "plugins/lisa/gates.yaml (v1.1, 31 gates, 5 stages, 298 lines)",
    "pyyaml_fallback": true,
    "fallback_description": "When PyYAML is not installed, validate.py runs in fallback mode using built-in subset of gates (file_exists, file_count, json_valid, json_field_present, json_field_count). Pattern-based checks skipped with warning.",
    "check_types": ["file_exists", "file_count", "json_valid", "json_field_present", "json_field_count", "pattern_exists", "pattern_count", "cross_reference"],
    "exit_codes": {"pass": 0, "blocker_failed": 1, "warning_failed": 2, "security_error": 3},
    "path_security": "All validated paths must resolve within working directory. Allowed: ., .gt, scopecraft"
  },
  "reconcile": {
    "ecosystem_config": "~/.lisa/ecosystem.json (ecosystem-config-v2)",
    "ecosystem_config_v2_features": ["remote field per project (git remote URL)", "backward compatible with v1"],
    "standalone_mode": "Works with 0-1 projects when ecosystem.json missing or single-project",
    "incremental_mode": "Compares git hashes from prior checkpoint; skips unchanged projects",
    "git_remote_fallback": "When path not found, tries matching git remote get-url origin",
    "checkpoint_schema": "reconcile-checkpoint-v1 (plugins/lisa/skills/reconcile/checkpoint-schema.json)",
    "checkpoint_fields": ["git_hash per project", "remote URL per project", "scan_mode (full/incremental/cached)"],
    "output_templates": 3,
    "quality_gates": 9,
    "graceful_degradation": "Missing partners produce informational message, not error",
    "latest_version": "v6.0.0 (2026-02-24) — 30 alignments, 0 misalignments, 2 LOW gaps"
  },
  "pipeline": {
    "stages": [
      {"number": 0, "name": "research", "output": ".gt/research/", "agent": "archaeologist"},
      {"number": 1, "name": "discover", "output": ".gt/memory/", "agent": "migrator"},
      {"number": 2, "name": "plan", "output": "scopecraft/", "agent": "migrator"},
      {"number": 3, "name": "structure", "output": ".gt/beads/, .gt/convoys/", "agent": "migrator"},
      {"number": 5, "name": "reconcile", "output": "scopecraft/ (alignment)", "agent": "migrator"}
    ],
    "note": "Stage 4 is intentionally reserved/skipped",
    "workflows": {
      "migrate": ["discover", "plan", "structure"],
      "rescue": ["research", "discover", "plan", "structure"],
      "ecosystem": ["reconcile"]
    }
  },
  "bead_schema": {
    "schema_version": "bead-v1",
    "canonical_source": "~/github/steveyegge/beads/internal/types/types.go",
    "aligned_with_real_bd": true,
    "fields": {
      "id": "gt-xxxxx (5-char alphanumeric, rig prefix gt-)",
      "title": "string",
      "description": "string (why + what)",
      "design": "string (implementation approach)",
      "acceptance_criteria": "STRING (newline-separated) — NOT array",
      "notes": "string (background references)",
      "issue_type": "feature | bug | task | chore | epic | decision (NOT 'type')",
      "priority": "INTEGER 0-4 (0=critical, 1=high, 2=medium, 3=low, 4=backlog) — NOT string",
      "status": "open | in_progress | blocked | deferred | closed (NOT 'pending')",
      "assignee": "string",
      "labels": "array",
      "dependencies": "array of bead IDs"
    },
    "metadata": {
      "complexity": "XS | S | M | L | XL (NOT a top-level bd field)",
      "epic": "string",
      "evidence": {"source": "file path", "line": "integer", "extracted": "ISO timestamp"}
    },
    "template_path": "plugins/lisa/skills/structure/templates/bead.json"
  },
  "convoy_schema": {
    "schema_version": "convoy-v1",
    "id_format": "convoy-NNN (3-digit, padded)",
    "eco_id_format": "eco-convoy-NNN (ecosystem convoys)",
    "size_rule": "3-7 beads per convoy",
    "gt_convoy_cmd": "gt convoy create '<name>' <bead-id-1> <bead-id-2> ...",
    "template_path": "plugins/lisa/skills/structure/templates/convoy.json"
  },
  "gastown_toolchain": {
    "canonical_ref": "~/github/steveyegge/gastown (cloned 2026-02-24)",
    "architecture_doc": "~/github/steveyegge/gastown/docs/overview.md",
    "tools": {
      "bd": "Beads CLI — issue tracking backed by Dolt SQL database (.beads/ dir). Commands: bd create, bd ready, bd update, bd close, bd sync",
      "bv": "Graph analysis CLI (read-only). Always use --robot-* flags (e.g., --robot-triage), never bare bv",
      "gt": "Gastown workspace manager — convoys, polecats (ephemeral workers), rigs (roles), git worktrees. Commands: gt convoy create, gt sling, gt convoy status"
    },
    "propulsion_principle": "If you find something on your hook, YOU RUN IT. Agents execute immediately when a bead is slotted.",
    "staging_vs_live": "Lisa's .gt/beads/*.json and .gt/convoys/*.json are staging format. Real execution uses bd create + gt convoy create + gt sling.",
    "mayor": "Mayor singleton role assigns beads via gt sling <bead-id> <rig>"
  },
  "upstream_refs": {
    "steveyegge/beads": {
      "local_path": "~/github/steveyegge/beads",
      "cloned": "2026-02-24",
      "purpose": "Canonical bd Issue schema (internal/types/types.go)",
      "key_file": "internal/types/types.go"
    },
    "steveyegge/gastown": {
      "local_path": "~/github/steveyegge/gastown",
      "cloned": "2026-02-24",
      "purpose": "Architecture reference (docs/overview.md, role taxonomy, toolchain docs)",
      "key_file": "docs/overview.md"
    }
  },
  "ecosystem_position": {
    "stack": "Gastown → Conductor → Lisa/Carlos",
    "role_in_stack": "Lisa is the pipeline and memory layer. Creates the .gt/ schema, quality gates, and staged pipeline. Carlos is a specialist fixer (peer). Conductor is the orchestration layer above both.",
    "scopecraft_as_shared_language": "scopecraft/ output is the shared language: Lisa writes it (plan stage), Carlos refines it, Conductor reads it as context bundles",
    "spin_off_note": "Lisa is a Gastown spin-off — learns from the real bd/gt toolchain but operates standalone as a Claude Code plugin"
  },
  "documentation": {
    "readme": "README.md (rewritten for v0.3.0, install + commands + output structure + ecosystem)",
    "changelog": "CHANGELOG.md (v0.1.0, v0.2.0, v0.3.0 with added/changed/deprecated/breaking)",
    "getting_started": "docs/GETTING_STARTED.md (install to first output in 15 minutes)",
    "architecture": "docs/ARCHITECTURE_V2.md (5-stage pipeline design)",
    "claude_md": "CLAUDE.md (development commands, architecture, file relationships, full Ecosystem Position section with stack diagram and role boundary table)"
  },
  "plugin_structure": {
    "active_plugin": "plugins/lisa/ (v0.3.0)",
    "deprecated_plugin": "plugins/lisa-loops-memory/ (v0.2.0, DEPRECATED.md with migration table)",
    "marketplace_registry": ".claude-plugin/marketplace.json (lists both, deprecated flag on legacy)",
    "commands": 8,
    "deprecated_commands": 6,
    "skill_files": 5,
    "template_dirs": 5,
    "total_plugin_files": 41
  },
  "personas": [
    {"name": "Solo developer with abandoned projects", "need": "Context recovery and structured work extraction", "priority": 1},
    {"name": "Small team migrating to multi-agent", "need": "Structured work items for Gastown execution", "priority": 1},
    {"name": "Ecosystem operator", "need": "Cross-project alignment and drift detection", "priority": 2}
  ],
  "constraints": [
    "Works offline after initial clone",
    "All outputs are local files (no database required)",
    "Python 3.10+ (PyYAML optional — fallback mode available)",
    "Plugins must degrade gracefully when ecosystem partners are absent",
    "Allowed output directories: ., .gt, scopecraft (enforced by validate.py)"
  ],
  "non_goals": [
    "Specialist analysis (Carlos's job)",
    "Multi-agent tracking and orchestration (Conductor's job)",
    "Model routing or cost optimization (Carlos/Conductor)",
    "Web UI or dashboard"
  ],
  "integration_points": {
    "carlos": {
      "provides": ".gt/memory/semantic.json (discovery output), gates.yaml (quality gate schema), scopecraft/ format",
      "receives": "Richer analysis reports, quality gate enforcement, market fit scoring"
    },
    "conductor": {
      "provides": ".gt/beads/*.json, .gt/convoys/*.json (structured work items)",
      "receives": "Task assignment (conductor_import_beads), agent lifecycle management, context rollover"
    }
  },
  "evidence": {
    "last_scan": "2026-02-24T12:00:00Z",
    "files_analyzed": [
      "README.md",
      "CHANGELOG.md",
      "CLAUDE.md",
      "docs/GETTING_STARTED.md",
      "docs/ARCHITECTURE_V2.md",
      "plugins/lisa/.claude-plugin/plugin.json",
      ".claude-plugin/marketplace.json",
      "plugins/lisa/gates.yaml",
      "plugins/lisa/hooks/validate.py",
      "plugins/lisa/commands/discover.md",
      "plugins/lisa/commands/plan.md",
      "plugins/lisa/commands/research.md",
      "plugins/lisa/commands/structure.md",
      "plugins/lisa/commands/status.md",
      "plugins/lisa/commands/migrate.md",
      "plugins/lisa/commands/rescue.md",
      "plugins/lisa/commands/reconcile.md",
      "plugins/lisa/agents/archaeologist.md",
      "plugins/lisa/agents/migrator.md",
      "plugins/lisa/skills/discover/SKILL.md",
      "plugins/lisa/skills/plan/SKILL.md",
      "plugins/lisa/skills/research/SKILL.md",
      "plugins/lisa/skills/structure/SKILL.md",
      "plugins/lisa/skills/structure/templates/bead.json",
      "plugins/lisa/skills/structure/templates/convoy.json",
      "plugins/lisa/skills/reconcile/SKILL.md",
      "plugins/lisa/skills/reconcile/checkpoint-schema.json",
      "plugins/lisa/skills/reconcile/templates/ALIGNMENT_REPORT_FORMAT.md",
      "plugins/lisa/skills/reconcile/templates/PERSPECTIVES_FORMAT.md",
      "plugins/lisa/skills/reconcile/templates/CHECKPOINT_FORMAT.json",
      "plugins/lisa/skills/plan/templates/VISION_FORMAT.md",
      "plugins/lisa/skills/plan/templates/ROADMAP_FORMAT.md",
      "plugins/lisa/skills/plan/templates/EPICS_FORMAT.md",
      "plugins/lisa/skills/plan/templates/RISK_REGISTER_FORMAT.md",
      "plugins/lisa/skills/plan/templates/METRICS_FORMAT.md",
      "plugins/lisa/skills/plan/templates/OPEN_QUESTIONS_FORMAT.md",
      "plugins/lisa-loops-memory/DEPRECATED.md",
      "tests/test_validate_quality_gates.py",
      "scripts/bump-version.sh",
      "scopecraft/.checkpoint.json",
      "scopecraft/ALIGNMENT_REPORT.md",
      "scopecraft/PERSPECTIVES.md",
      "~/github/steveyegge/beads/internal/types/types.go",
      "~/github/steveyegge/gastown/docs/overview.md"
    ],
    "previous_scan": "2026-02-10T15:00:00Z",
    "delta_since_previous": "2026-02-24 Gastown grounding session (4 Lisa commits + 6 total ecosystem commits): (1) bump-version.sh fixed — was pointing at deprecated plugins/lisa-loops-memory, now correctly targets plugins/lisa; (2) CLAUDE.md full Ecosystem Position section added — stack diagram (Gastown→Conductor→Lisa/Carlos), role boundaries, interface contracts, context budget principle; (3) bead.json template aligned with real bd Issue type (priority=int 0-4, acceptance_criteria=string NOT array, status=open NOT pending, issue_type NOT type, complexity/evidence moved to metadata); (4) convoy.json got gt_convoy_cmd field; (5) structure/SKILL.md updated with bd/gt CLI integration, Issue Types table, Priority Values table, Propulsion Principle, Live Integration Workflow; (6) ~/github/steveyegge/beads and ~/github/steveyegge/gastown cloned as canonical upstream refs; (7) All 3 CLAUDE.md files now have comprehensive Ecosystem Position sections; (8) Reconcile v6.0.0 completed — 30 alignments, 0 misalignments, 2 LOW gaps (G8 conductor MCP categories, G10 was this stale semantic.json now resolved)."
  }
}
